RewriteEngine On
RewriteBase /parroquia/

# Denegar acceso a archivos sensibles en root/
RewriteRule ^root/(config\.php|utils\.php)$ - [F,L]

# Permitir solo archivos específicos en api
RewriteCond %{REQUEST_URI} ^/parroquia/api/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^api/(?!login\.php|validate_empleado\.php|empleados_disponibles\.php|guardar_liquidacion_masiva\.php|respaldo\.php)(.*)$ - [F,L]

# Rewrite para módulos clean URLs: /empleados -> index.php?module=empleados
RewriteRule ^(empleados|liquidacion|aprobacion|comprobante|reportes|importarEmpleados|manual|configuracion)$ index.php?module=$1 [L,QSA]

# Headers de seguridad
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains" env=HTTPS
</IfModule>

# Permitir acceso a dist/ para assets (si se usa)
<IfModule mod_rewrite.c>
    RewriteCond %{REQUEST_URI} ^/parroquia/dist/
    RewriteRule ^dist/ - [L]
</IfModule>